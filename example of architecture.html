<!DOCTYPE html>
<html lang="pt-br">
<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        body { margin: 0; background: #0a0a0c; color: #fff; font-family: sans-serif; overflow: hidden; }
        #ui { position: absolute; top: 20px; left: 20px; z-index: 10; pointer-events: none; }
        .metric { margin-bottom: 10px; font-size: 14px; letter-spacing: 1px; }
        .val { font-weight: bold; color: #00ffcc; }
        h1 { font-size: 18px; margin-bottom: 20px; opacity: 0.7; }
    </style>
</head>
<body>
    <div id="ui">
        <h1>AYANODE // PROTOTYPE_V1</h1>
        <div class="metric">DOMÍNIO: <span id="dom" class="val">MISTO</span></div>
        <div class="metric">COERÊNCIA (I): <span id="icoer" class="val">0.00</span></div>
        <div class="metric">POTENCIAL (U): <span id="u_pot" class="val">0.00</span></div>
        <div class="metric">TENSÃO (T): <span id="tens" class="val">0.00</span></div>
    </div>

<script>
// --- Lógica AyaNode Adaptada para JS ---
let node = {
    spin: Array.from({length: 16}, () => Math.random() * 2 - 1),
    rho: 1.0,
    D: 12,
    u_local: 0.5,
    tension: 0.01,
    icoer: 0.9
};

function normalize(v) {
    let norm = Math.sqrt(v.reduce((a, b) => a + b*b, 0)) + 1e-12;
    return v.map(x => x / norm);
}

function updateAyaLogic() {
    // Simulação de pulso de ressonância
    let base = new Array(16).fill(1);
    let lam = 0.05;
    let noise = 0.02;

    // Evolução do Spin
    for(let i=0; i<16; i++) {
        node.spin[i] = (1 - lam) * node.spin[i] + lam * base[i] + (Math.random() - 0.5) * noise;
    }
    node.spin = normalize(node.spin);

    // Métricas aproximadas para visualização
    node.icoer = 0.8 + Math.random() * 0.15;
    node.u_local = (node.icoer * 0.9) - (node.tension * 0.1);
    node.tension = Math.abs(Math.sin(frameCount * 0.01)) * 0.05; // Oscilação simulada de rede

    // Atualiza UI
    document.getElementById('icoer').innerText = node.icoer.toFixed(4);
    document.getElementById('u_pot').innerText = node.u_local.toFixed(4);
    document.getElementById('tens').innerText = node.tension.toFixed(4);
}

// --- Visualização com p5.js ---
function setup() {
    createCanvas(windowWidth, windowHeight);
    node.spin = normalize(node.spin);
}

function draw() {
    background(10, 10, 12, 25); // Efeito de rastro (motion blur)
    updateAyaLogic();
    
    translate(width/2, height/2);
    
    let numParticles = 64;
    let radius = 150 + (node.u_local * 50);
    let tensionEffect = node.tension * 200;

    for (let i = 0; i < numParticles; i++) {
        let angle = TWO_PI / numParticles * i;
        let spinVal = node.spin[i % 16];
        
        // A geometria reage ao Spin e à Tensão
        let x = cos(angle) * (radius + spinVal * 30);
        let y = sin(angle) * (radius + spinVal * 30);
        
        // Se a tensão sobe, as partículas tremem
        x += random(-tensionEffect, tensionEffect);
        y += random(-tensionEffect, tensionEffect);

        stroke(0, 255, 204, 150);
        strokeWeight(2);
        point(x, y);
        
        // Linhas de conexão (Ressonância entre componentes do spin)
        if (i % 4 == 0) {
            stroke(0, 255, 204, 30);
            line(0, 0, x, y);
        }
    }

    // O "Núcleo" (Core)
    noFill();
    stroke(255, 255, 255, 50);
    ellipse(0, 0, radius * 0.2);
}

function windowResized() {
    resizeCanvas(windowWidth, windowHeight);
}
</script>
</body>
</html>